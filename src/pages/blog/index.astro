---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Footer from '../../components/Footer.astro';
import PostCard from '../../components/PostCard';
import SectionHeader from '../../components/SectionHeader.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: '2-digit'
  });
}
---

<BaseLayout title="Blog - Json Lee">
  <main class="px-6 md:px-12 lg:px-24 max-w-5xl mx-auto py-20">
    <div class="mb-16">
      <a href="/" class="inline-flex items-center text-sm font-mono text-gray-500 hover:text-black transition-colors mb-8">
        ‚Üê Back to Home
      </a>
      <SectionHeader number="02" title="All Writing" />
      <p class="text-gray-500 leading-relaxed max-w-2xl">
        Thoughts on software engineering, design patterns, and the future of web development.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {posts.map((post) => (
        <a href={`/blog/${post.id}/`} class="block">
          <div class="group bg-surface border border-border p-6 md:p-8 cursor-pointer relative overflow-hidden hover:-translate-y-1 transition-transform duration-300">
            {post.data.heroImage && (
              <div class="mb-4 -mx-6 -mt-6 md:-mx-8 md:-mt-8">
                <Image
                  width={720}
                  height={360}
                  src={post.data.heroImage}
                  alt=""
                  class="w-full h-48 object-cover"
                />
              </div>
            )}
            <div class="flex justify-between items-start mb-4">
              <span class="text-xs font-mono text-accent uppercase tracking-wider border border-accent/20 px-2 py-1 rounded-full">
                Article
              </span>
              <span class="text-xs font-mono text-graphite">{formatDate(post.data.pubDate)}</span>
            </div>
            <h3 class="font-serif text-2xl mb-2 group-hover:text-accent transition-colors duration-300">
              {post.data.title}
            </h3>
            <p class="text-graphite text-sm leading-relaxed line-clamp-2">
              {post.data.description}
            </p>
          </div>
        </a>
      ))}
    </div>

    <Footer />
  </main>
</BaseLayout>
