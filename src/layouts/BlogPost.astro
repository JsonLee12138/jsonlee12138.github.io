---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import Footer from '../components/Footer.astro';
import ReadingProgress from '../components/ReadingProgress';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<BaseLayout title={`${title} - Json Lee`} description={description}>
  <ReadingProgress client:load />

  <main class="px-6 md:px-12 lg:px-24 max-w-4xl mx-auto py-20">
    <article>
      <a href="/blog" class="inline-flex items-center text-sm font-mono text-gray-500 hover:text-black transition-colors mb-8">
        ← Back to Blog
      </a>

      {heroImage && (
        <div class="mb-8 -mx-6 md:-mx-12 lg:-mx-24">
          <Image
            width={1200}
            height={600}
            src={heroImage}
            alt=""
            class="w-full rounded-lg shadow-lg"
          />
        </div>
      )}

      <header class="mb-12 border-b border-border pb-8">
        <div class="flex items-center gap-4 text-sm font-mono text-graphite mb-4">
          <time datetime={pubDate.toISOString()}>
            {formatDate(pubDate)}
          </time>
          {updatedDate && (
            <span class="italic">
              (Updated: {formatDate(updatedDate)})
            </span>
          )}
        </div>
        <h1 class="font-serif text-4xl md:text-5xl lg:text-6xl font-bold text-ink leading-tight mb-4">
          {title}
        </h1>
        <p class="text-xl text-graphite leading-relaxed">
          {description}
        </p>
      </header>

      <div class="prose max-w-none">
        <slot />
      </div>

      <div class="mt-16 pt-8 border-t border-border">
        <a href="/blog" class="inline-flex items-center text-sm font-mono text-accent hover:text-ink transition-colors">
          ← See all articles
        </a>
      </div>
    </article>

    <Footer />
  </main>
</BaseLayout>
